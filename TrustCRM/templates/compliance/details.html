<!doctype html>
<html lang="en">

<head>

    <meta charset="utf-8" />
    <title>Trust Capital CRM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Premium Multipurpose Admin & Dashboard Template" name="description" />
    <meta content="Themesbrand" name="author" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" lang="ar">
    <!-- App favicon -->
    {% load  static %}
     <!-- DataTables -->
     <link href="{% static 'libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css' %}" rel="stylesheet" type="text/css" />
     <link href="{% static 'libs/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css' %}" rel="stylesheet" type="text/css" />
     <!-- plugin css -->
     <!--<link href="assets/libs/admin-resources/jquery.vectormap/jquery-jvectormap-1.2.2.css" rel="stylesheet"
         type="text/css" />-->
      <!-- datepicker css -->
      <link rel="stylesheet" href="{% static 'libs/flatpickr/flatpickr.min.css' %}">
      
      <link href="{% static 'css/input-tel.min.css' %}" rel="stylesheet"   type="text/css" />
    {% include "common/link.html" %}
    {% include "common/scripts.html" %}

   

 
</head>
<body data-layout-mode="dark">

    <!-- <body data-layout="horizontal"> -->
    
    <!-- Begin page -->
    <div id="layout-wrapper">
    
        {% include "common/header.html" %}
    

        <!-- ========== Left Sidebar Start ========== -->
        {% include "common/sidebar.html" %}
        <div class="main-content ">

            <div class="page-content " id="sales">
                <div class="container-fluid">
                              <!-- start page title -->
                              <div class="row">
                                  <div class="col-12">
                                      <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                                          <h4 class="mb-sm-0 fs-23 almarenamonolight-type">Complaint details </h4><!--font-size-18-->
    
                                          <!--<div class="page-title-right">
                                              <ol class="breadcrumb m-0">
                                                  <li class="breadcrumb-item"><a href="javascript: void(0);">Dashboard</a></li>
                                                  <li class="breadcrumb-item active">CRF case details </li>
                                              </ol>
                                          </div>-->
    
                                      </div>
                                  </div>
                              </div>
                              <!-- end page title -->       
                              <div class=" mb-4">
                                <p class="gilroymedium-type fs-15 color-color1 mb-0">This page allows you to see the list of all complaints.</p>
    
                                <hr class="my-4">
                                </div>
                                   <!--Search-->
                                   <div class="row align-items-end">
    
                                    <!-- <div class="col-xxl-6 col-md-6 mb-2 ">
        
                                        <div class="row">
        
                                        
                                            <div class="col-12">
        
                                                <form class="">
                                                    <div class="row align-items-end ">
                                                      
                                                        <div class="col-sm-4 col-xxl-4">
                                                            <div class="mb-2">
                                                                <label class="form-label " for="Fromdate1">From date<span class="color-orange">*</span></label>
                                                                <input  type="text" class="form-control" id="Fromdate1" placeholder="" required>
                                                                
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 col-xxl-4">
                                                            <div class="mb-2">
                                                                <label class="form-label " for="Todate1">To date<span class="color-orange">*</span></label>
                                                                <input  type="text" class="form-control" id="Todate1" placeholder="" required>
                                                                    
                                                                
                                                            </div>
                                                        </div>
                                                       
                                                        <div class="col-sm-4 col-xxl-2 " >
                                                                <button class="btn  btn-info  btn-lg mb-2  me-2
                                                                " type="button" id="" onclick="loadAll()">Load All</button>
                                                        </div>
                                                       
                                                </div> 
                                                </form>
                                            </div>
                                        
                                        </div>
        
                                            
                                    </div> -->
                                    <div class="col-xxl-6 col-md-6  mb-2 ">
    
                                        <div class="row ">
    
                                            <div class="col-md-6 col-xxl-7"> 
    
                                                <div class="mb-2">
    
                                                    <input type="text" class="form-control  " placeholder="Search" id="myinputsearch1" >
                                                </div>
                                               
    
                                            </div>
                                            <div class="col-md-6 col-xxl-5 d-flex justify-content-end flex-shrink-0">
                                                <div class="mb-2">
                                                    <div id="datatable-buttons_wrapper1">
        
                                                    </div>
                                                </div>
                                                
                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                </div>
                               <!--Data Table-->
                                <div class="row">
                                    <div class="col-12">
                                             
                                              <div class="card">
    
                                                    <div class="card-body" id="tasks-div">
    
                                                        <div class="table-responsive "   data-simplebar="init" >
        
                                                  
                                                            <table  class="table dt-responsive  nowrap  w-100 change" id="datatable">
                                                                <thead class="color-color1">
                                                                    <tr  class=" gilory-medium-type fs-17 ">
                                                                        <th  class="ps-0"> Name</th>
                                                                        <th >Email</th>
                                                                        <th  >Phone</th>
                                                                        <th  >Status</th>
                                                                        <th>Description</th>
                                                                        <th>Date</th>
                                                                        
                                                                        <th class="text-end "></th>
                                                                        
                                                                    </tr>
                                                                </thead>
                
                
                                                                <tbody class="text-white giloryregular-type fs-16" >
                                                                    {%for complaint in complaints%}
                                                                    <tr>
                                                                       <td class="ps-0">{{complaint.1}}</td>
                                                                       <td>{{complaint.2}}</td>
                                                                       <td>{{complaint.3}}</td>
                                                                       <td>{{complaint.4}}</td>
                                                                       <td>{{complaint.5}}</td>
                                                                       <td>{{complaint.6}}</td>
                                                                       <td>
                                                                        <div class='dropdown align-self-start'><a class='dropdown-toggle' href='#' role='button' data-bs-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>
                                                                            <i class='bx bx-dots-vertical-rounded'></i></a>
                                                                            <div class='dropdown-menu' style='cursor:pointer'>
                                                                                <a class='dropdown-item' onclick="viewDetails({{complaint.0}})">View Details</a><a class='dropdown-item' onclick="editcomplaint({{complaint.0}})">
                                                                                Edit</a></div></div>
                                                                            </td>
                                                                    
                                                                    </tr>
                                                                    {%endfor%}
                                                                
                                                                </tbody>
                                                            
                                                            </table>
                                                        </div>
                                                    </div>
                                              </div>
                                                
                                              
        
                                     
                                    </div>
                                </div>   
                                
                                <!--Model-->
                                       <!---Modal Upload document-->
                                       <div class="modal fade  bs-example-modal-show" tabindex="-1" role="dialog" aria-hidden="true" id="resolve-model">
                                                            
                                        <div class="modal-dialog modal-dialog-centered">
                                            <div class="modal-content ">
    
    
    
                                                <div class="modal-body ">
    
    
                                                    <div class="  px-0  ">
    
                                                        <div class="modal-header border-0 px-0">
                                                            <h5 class="modal-title fs-21 ">Resolve Case </h5>
    
                                                            <a href="" data-bs-dismiss="modal" aria-label="Close">
                                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                    <path d="M9.16992 14.83L14.8299 9.17" stroke="var(--white)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                                    <path d="M14.8299 14.83L9.16992 9.17" stroke="var(--white)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                                    <path d="M9 22H15C20 22 22 20 22 15V9C22 4 20 2 15 2H9C4 2 2 4 2 9V15C2 20 4 22 9 22Z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                                    </svg>
    
                                                                </a>
                                                        </div>
                                                        <form class="needs-validation pt-3" novalidate="" id="action-call">
                                                            <div class="row">
    
    
                                                                <div class="col-md-12">
                                                                    <div class="mb-3 d-flex">
                                                                        <label class="form-label me-2" for="Choosefile">Caseld : </label>
                                                                        
                                                                        <span id="resolveCaseId">4</span>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-12">
                                                                    <div class="mb-3 d-flex">
                                                                        <label class="form-label me-2" for="Choosefile">CaseCode : </label>
                                                                        
                                                                        <span id="resolveCasecode"></span>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-12">
                                                                    <button class="btn btn-primary btn-lg my-3 " type="button" onclick="resolved()">Resolve</button>
                                                                </div>
    
                                                            </div>
    
    
                                                        </form>
    
                                                    </div>
                                                </div><!-- /.modal-content -->
    
    
    
                                            </div>
    
    
                                        </div><!-- /.modal-dialog -->
                                    </div>
                      
                </div>
                <!-- End Page-content -->
                
            </div>
            <!-- end main content-->
        </div>
    </div>
    {% include "common/right-sidebar.html" %}
    
    <!-- Right bar overlay-->
<div class="rightbar-overlay"></div> 
<div class="modal fade" id="view-details" tabindex="-1" >
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <div class="modal-body ">

                <div class="border-dashed rounded-3 px-3 py-3">
                
                    <div class="modal-header border-0 px-0">
                        <h5 class="modal-title fs-21" id="modal-title">More Details</h5>

                        <a href="" data-bs-dismiss="modal" aria-label="Close">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M9.16992 14.83L14.8299 9.17" stroke="var(--white)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M14.8299 14.83L9.16992 9.17" stroke="var(--white)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M9 22H15C20 22 22 20 22 15V9C22 4 20 2 15 2H9C4 2 2 4 2 9V15C2 20 4 22 9 22Z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>

                            </a>

                    </div>          
                    <form id="add-card-form" enctype="multipart/form-data">  
                                          
                                        <div class="row">
                        
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label class="form-label w-100 " for="email1">Name </label>
                                                        <input type="text" id="name" class="form-control" required  readonly>
                                                        <div id="noname" style="color: red">
                                                        </div>
                                                </div>
                                            </div>
                                            <!-- <div class="col-12">
                                                <div class="mb-3">
                                                    <label class="form-label w-100 " for="email1">Email</label>
                                                        <input type="tel" maxlength="4" id="email"  class="form-control" readonly>
                                                        <div  id="nodigit" style="color: red">
                                                        </div>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label class="form-label w-100 " for="email1">Phone</label>
                                                    <input type="tel" maxlength="4" id="phone"  class="form-control" readonly>
                                                </div>
                                            </div> -->
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label class="form-label w-100 " for="email1">Status</label>
                                                    <input type="tel" maxlength="4" id="cmtstatus"  class="form-control" readonly>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label class="form-label w-100 " for="email1">Description</label>
                                                    <input type="tel" maxlength="4" id="description"  class="form-control" readonly>    
                                                        
                                                       
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label for="files" class="form-label w-100 ">Date</label>
                                                    <input type="tel" maxlength="4" id="date"  class="form-control" readonly>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label for="files" class="form-label w-100 ">Priority</label>
                                                    <input type="tel" maxlength="4" id="priority"  class="form-control" readonly>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label for="files" class="form-label w-100 ">Modified Date</label>
                                                    <input type="tel" maxlength="4" id="modified"  class="form-control" readonly>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label for="files" class="form-label w-100 ">Remarks</label>
                                                    <input type="tel" maxlength="4" id="remarks"  class="form-control" readonly>
                                                </div>
                                            </div>
                                           
                                        </div>
                                        
                                        
                    </form>  
                                    
                                
                                    
                </div>
            
            </div>
        </div> <!-- end modal-content-->
    </div> <!-- end modal dialog-->
</div>
<div class="modal fade bs-example-modal-insta" tabindex="-1" role="dialog" aria-hidden="true" id="alertpopup">
    <div class="modal-dialog modal-dialog-centered"   style="z-index: 10555;">
        <div class="modal-content">
            <div class="modal-header border-0">
                <h5 class=" fs-16" id="userMsg">
                    
                </h5>
                <a href="" data-bs-dismiss="modal" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9.16992 14.83L14.8299 9.17" stroke="var(--white)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M14.8299 14.83L9.16992 9.17" stroke="var(--white)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 22H15C20 22 22 20 22 15V9C22 4 20 2 15 2H9C4 2 2 4 2 9V15C2 20 4 22 9 22Z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>

                    </a>
                </div>
                                    
                    <!-- <div class="modal-body" >
        
        
                            <div data-simplebar style="max-height: 230px;">
            
                              
                                
                            </div>
                        </div> -->
           
        </div>
     </div>
    </div>
<div class="modal fade" id="edit-details" tabindex="-1" >
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <div class="modal-body ">

                <div class="border-dashed rounded-3 px-3 py-3">
                
                    <div class="modal-header border-0 px-0">
                        <h5 class="modal-title fs-21" id="modal-title">Edit Details</h5>

                        <a href="" data-bs-dismiss="modal" aria-label="Close">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M9.16992 14.83L14.8299 9.17" stroke="var(--white)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M14.8299 14.83L9.16992 9.17" stroke="var(--white)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M9 22H15C20 22 22 20 22 15V9C22 4 20 2 15 2H9C4 2 2 4 2 9V15C2 20 4 22 9 22Z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>

                            </a>

                    </div>          
                    <form>  
                                       
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label class="form-label w-100 " for="email1">Status</label>
                                                    <select  class="form-select" id="status-update"  value="" required name="assignedto">
                                            
                                                        <option value="Resolved">Resolved</option>
                                                        
                                                        <option value="Followup">Followup</option>
                                                        <option value="ReOpen">ReOpen</option>
                                                        <option value="Pending">Pending</option>
                                                        
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="mb-3">
                                                    <label class="form-label" >Remarks</label>
                                                    
                                                    <textarea name="description" id="status-description" class="form-control"></textarea>
                                                </div>
                                            </div>
                                            <input type="hidden" name="caseid" id="ComplaintId">
                                            <div class="col-md-12">
                                                <button class="btn btn-primary btn-lg my-3 " type="button" onclick="complaintUpdate()">Update</button>
                                            </div>
                                        </div>
                                        
                                        
                    </form>  
                                    
                                
                                    
                </div>
            
            </div>
        </div> <!-- end modal-content-->
    </div>
    <script>
        function viewDetails(complaintId){
            $.ajax({
                    
                    type : "GET", 
                    url: "{% url 'Admin:ComplianceDetails' %}",
                    dataType: 'json',
                    data:{
                        'id':complaintId,
                       
                    },
                    success: function(data){
                        var more=data.details
                        var newreg
                        var newmodify
                        console.log("Details====",data.details)
                        $("#name").val(more[1])
                        $("#email").val(more[2])
                        $("#phone").val(more[3])
                        $("#cmtstatus").val(more[4])
                        $("#description").val(more[5])
                        var regdate=more[6]
                        if(regdate!=""){
                            newreg=new Date(regdate)
                            newreg=newreg.toISOString().substring(0, 10)
                        }
                        $("#date").val(newreg)
                        $("#priority").val(more[8])
                        var modify=more[9]
                        if(modify!=""){
                            newmodify=new Date(modify)
                            newmodify=newmodify.toISOString().substring(0, 10)
                        }
                        $("#modified").val(newmodify)
                        $("#remarks").val(more[10])
                        $("#view-details").modal('show')
                    }
            })
            
        }
        function editcomplaint(complaintId){
            $("#ComplaintId").val(complaintId)
            $("#edit-details").modal('show')
        }
        function complaintUpdate(){
            $("#edit-details").modal('hide')
            var cmpId=$("#ComplaintId").val()
            var status=$("#status-update").val()
            var desc=$("#status-description").val()
            $.ajax({
                    
                    type : "GET", 
                    url: "{% url 'Admin:ComplianceUpdate' %}",
                    dataType: 'json',
                    data:{
                        'id':cmpId,
                        'status':status,
                       'desc':desc
                    },
                    success: function(data){
                        $('#tasks-div').load(document.URL +  ' #tasks-div')
                        $("#userMsg").empty()
                        $("#userMsg").append(data.message)
                        $("#alertpopup").modal('show')
                        $("#status-description").val("")
                    }
                })
        }
    </script>
<script src="{% static 'libs/flatpickr/flatpickr.min.js' %}"></script>
<!-- Required datatable js -->
<script src="{% static 'libs/datatables.net/js/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'libs/datatables.net-bs4/js/dataTables.bootstrap4.min.js' %} "></script>
<!-- Datatable init js -->
<script src="{% static 'js/pages/botrans.init.js' %}"></script> 
<script src="{% static 'libs/datatables.net-buttons/js/dataTables.buttons.min.js' %}"></script>
<script src="{% static 'libs/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js' %}"></script>
<script src="{% static 'libs/jszip/jszip.min.js' %}"></script>
<script src="{% static 'libs/pdfmake/build/pdfmake.min.js' %}"></script>
<script src="{% static 'libs/pdfmake/build/vfs_fonts.js' %}"></script>
<script src="{% static 'libs/datatables.net-buttons/js/buttons.html5.min.js' %}"></script>
<script src="{% static 'libs/datatables.net-buttons/js/buttons.print.min.js' %}"></script>
<script src="{% static 'libs/datatables.net-buttons/js/buttons.colVis.min.js' %}"></script>
<!-- Datatable init js -->
<script src="{% static 'js/pages/crf/crfdetails.init.js' %}"></script> 

<script src="{% static 'js/app.js' %}"></script>

</body>

</html>